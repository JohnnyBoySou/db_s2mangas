{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "npm run railway:build"
  },
  "deploy": {
    "startCommand": "npm start",
    "healthcheckPath": "/health",
    "healthcheckTimeout": 30,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 5,
    "numReplicas": 1
  },
  "environments": {
    "production": {
      "variables": {
        "NODE_ENV": "production",
        "PORT": "$PORT",
        "DATABASE_URL": "$DATABASE_URL",
        "REDIS_URL": "$REDIS_URL",
        "JWT_SECRET": "$JWT_SECRET",
        "NEXTAUTH_SECRET": "$NEXTAUTH_SECRET",
        "NEXTAUTH_URL": "$RAILWAY_PUBLIC_DOMAIN",
        "SMTP_HOST": "$SMTP_HOST",
        "SMTP_USER": "$SMTP_USER",
        "SMTP_PASS": "$SMTP_PASS",
        "SMTP_PORT": "$SMTP_PORT",
        "SMTP_MAILER": "$SMTP_MAILER",
        "SMTP_ENCRYPTION": "$SMTP_ENCRYPTION",
        "SMTP_FROM_ADDRESS": "$SMTP_FROM_ADDRESS",
        "SMTP_FROM_NAME": "$SMTP_FROM_NAME",
        "GOOGLE_API_KEY": "$GOOGLE_API_KEY",
        "GOOGLE_CLIENT_ID": "$GOOGLE_CLIENT_ID",
        "GOOGLE_CLIENT_SECRET": "$GOOGLE_CLIENT_SECRET",
        "TESSERACT_SERVICE_URL": "$TESSERACT_SERVICE_URL",
        "ELASTIC_URL": "$ELASTIC_URL",
        "ELASTIC_USERNAME": "$ELASTIC_USERNAME",
        "ELASTIC_PASSWORD": "$ELASTIC_PASSWORD",
        "ELASTIC_INTERNAL_URL": "$ELASTIC_INTERNAL_URL",
        "SENTRY_DSN": "$SENTRY_DSN",
        "SENTRY_ENABLED": "$SENTRY_ENABLED",
        "SENTRY_TRACES_SAMPLE_RATE": "$SENTRY_TRACES_SAMPLE_RATE"
      }
    }
  }
}